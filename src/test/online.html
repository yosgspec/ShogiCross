<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width" />
	<title>オンライン対戦テスト - ShogiCross</title>
	<link rel=icon href="sample/img/favicon.min.svg">
	<link href="../shogicross.css" rel="stylesheet">
</head>
<body>
	<h1>ShogiCross オンライン対戦</h1>
	<button id="online-btn" style="margin: 20px; padding: 10px 20px; cursor: pointer; font-size: 1.2em;">オンライン対戦を始める</button>
	<div id="status"></div>
	<canvas id="online-canvas"></canvas>
	<p><a href=".." target="_parent">RETURN</a></p>

	<script type="module">
	import {gameSoft, BoardOnline} from "../ShogiCross/lib.js";
	const btn = document.getElementById("online-btn");
	const canvas = document.getElementById("online-canvas");
	const statusDiv = document.getElementById("status");

	btn.addEventListener("click", ()=>{
		const shogiOption = gameSoft["shogi"];
		if (!shogiOption) {
			statusDiv.textContent = "標準将棋が見つかりません。";
			return;
		}
		btn.style.display = "none";
		statusDiv.textContent = "マッチング待機中...";

		const board = new BoardOnline(canvas, {
				...shogiOption,
				playerOptions: [
					{gameName: "将棋", pieceSet: "default"},
					//{gameName: "将棋", pieceSet: "default"},
					{gameName: "チェス", pieceSet: "default"},
				],
				//serverURL: "https://shogicross-server.onrender.com",
				serverURL: "https://shogicross-server-828297429002.asia-northeast1.run.app/",
				//serverURL: "https://shogicross-server-cs-828297429002.asia-northeast1.run.app/",
				//serverURL: "https://shogicross-server-py-828297429002.asia-northeast1.run.app/",
				onReadyOnline(event, board){
					statusDiv.textContent = `対戦開始！ あなたはプレイヤー${event.playerId + 1}です。`;
				},
			},
		);
	});
	</script>
</body>
</html>
