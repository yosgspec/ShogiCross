<html>
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-46760069-2"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-46760069-2');
		</script>

		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width" />
		<title>ShogiCrossPieceViewer</title>
		<link rel=icon href="../favicon.ico">
		<link href="../gspec20.css" rel="stylesheet">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Kosugi&family=Noto+Serif+JP:wght@900&family=Noto+Serif+TC:wght@900&family=Noto+Serif:wght@900&display=swap" rel="stylesheet">
		<style>
			body {
				font-family:"Noto Serif JP","Noto Serif TC","Noto Serif",serif;
				font-size: 50px;
				line-height: 1.1em;
				font-weight: 900;
			}
			input, select, textarea {
				font-family:"Noto Serif JP","Noto Serif TC","Noto Serif",serif;
				font-size: 40px;
			}
			textarea {
				font-family: "Kosugi",monospace;
			}
		</style>
	</head>
	<body>
		<h2><u>ShogiCrossPieceViewer</u></h2>
		Piece:<br>
		<select id="pieceSelect" style="width: 600px;"></select><br>
		Size:<br>
		<input id="pieceSize" style="width: 100px;" value="300"> px<br>
		Canvas View:<br>
		<canvas id="pieceViewer"></canvas><br>
		Range:<br>
		<textarea id="pieceRange"readonly style="width:200px;height:8em;"></textarea>
		<div><a href="./">Game</a></div>
		<div><a href="https://github.com/yosgspec/CrossChess">GitHub</a></div>
		<div><a href="/">トップメニュー</a></div>

		<script type="module">
		import {Piece} from "./core/piece.js";
		import {canvasFont} from "./core/extendCanvasFont.js";

		(function(){
			const canvas = document.getElementById("pieceViewer");
			const pieceSelect = document.getElementById("pieceSelect");
			const pieceSize = document.getElementById("pieceSize");
			const pieceRange = document.getElementById("pieceRange");
			const ctx = canvas.getContext("2d");
			const pieces = Piece.getPieces(ctx, 100);
			Piece.piecesToList(pieces).forEach(([key, {name, gameName}])=>{
				const opt = document.createElement("option");
				opt.value = key;
				opt.textContent = `${key}:${name} (${gameName})`;
				pieceSelect.appendChild(opt);
			});
			canvasFont.import().then(pieceView);
			pieceSelect.addEventListener("change", pieceView);
			pieceSize.addEventListener("change", pieceView);

			function pieceView(){
				let size = +pieceSize.value;
				if(isNaN(size) || !pieceSize.value) size = 300;
				canvas.width = size;
				canvas.height = size;
				ctx.clearRect(0, 0, size, size);
				const piece = pieces[pieceSelect.value];
				piece.center = size/2;
				piece.middle = size/2;
				piece.size = size*0.9;
				piece.draw();
				pieceRange.value = pieces[pieceSelect.value].range.default.map(v=>v.join("")).join("\n");
			}
		})();
		</script>
	</body>
</html>
