<!DOCTYPE html>
<html>
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-46760069-2"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-46760069-2');
		</script>

		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta name="viewport" content="width=device-width" />
		<title>ShogiCross</title>
		<link rel=icon href="../favicon.ico">
		<link href="../gspec24.css" rel="stylesheet">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@900&display=swap" rel="stylesheet">
		<style>
			body {
				font-family:"Noto Serif JP",serif;
				font-weight: 900;
				line-height: 1.3em;
			}
		</style>
	</head>
	<body>
		<h1>将棋類紹介</h1>
		実際に動かして試すことができます。
		<main></main>
		<a href="./index.html">RETURN</a>
		<script type="module">
		import {gameSoft, Board} from "./ShogiCross/lib.js";
		const main = document.getElementsByTagName("main")[0];
		const vMain = document.createDocumentFragment();

		const gameSoftList = Object.entries(gameSoft);
		const detailsMap = new Map();
		for(const [gameName, option] of gameSoftList){
			const {name, variant, desc, url, useStand} = option;
			const div = document.createElement("div");
			div.id = gameName;

			const h = document.createElement(!variant? "h2": "h3");
			div.append(h);
			const a = document.createElement("a");
			h.append(a);
			a.href = url;
			a.target = "_blank";
			a.textContent = name;

			const p = document.createElement("p");
			div.append(p);
			p.textContent = `${desc}持ち駒${(useStand? "あり": "なし")}。`;

			const canvas = document.createElement("canvas");
			div.append(canvas);
			setTimeout(()=>Board.run(canvas, option), 0);

			if(name === variant){
				const details = document.createElement("details");
				div.append(details);
				detailsMap.set(name, details)
				details.id = name;
				details.style.display = "none";
				const summary = document.createElement("summary");
				details.append(summary);
				summary.style.cursor = "pointer";
				summary.textContent = "バリエーション";
				vMain.append(div);
			}
			else{
				const details = detailsMap.get(variant);
				details.style.display = "";
				details.append(div);
			}
		}
		main.appendChild(vMain);
		</script>
	</body>
</html>
